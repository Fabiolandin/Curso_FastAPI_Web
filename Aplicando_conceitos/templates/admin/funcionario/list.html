{% extends 'admin/base.html' %}
{% block container %}
<h1 class="h3 mb-2 text-gray-800">Gerenciar Funcionarios</h1>
<div class="card shadow mb-4">
    <div class="card-header py-3">
        <div class="ms-3 d-inline-block">
            <a href="{{ url_for('funcionario_create')}}" class="btn btn-primary"> + Cadastrar</a>
        </div>
    </div>
    <div class="card-body">
        <div class="table-responsive">
            <table classs="table table-bordered" id="dataTable" width="100%" cellscpacing="0">
                <thead>
                    <tr>
                        <th class="w-1"></th>
                        <th>ID</th>
                        <th>Nome do Funcionario</th>
                        <th>CPF</th>
                        <th>Cargo</th>
                        <th>Data de admiss√£o</th>
                    </tr>
                </thead>
                <tbody>
                    {% if dados %}
                    {% for dado in dados %}
                    <tr>
                        <td class="text-center">
                            <a href="{{ url_for('funcionario_details', funcionario_id=dado.id) }}" data-toggle="tooltip"
                                data-placement="top" title="Ver">
                                <span class="me-1 px-x">
                                    <i class="bi bi-eye"></i>
                                </span>
                            </a>
                            <a href="{{ url_for('funcionario_edit', funcionario_id=dado.id) }}" data-toggle="tooltip"
                                data-placement="top" title="Editar">
                                <span class="me-1 px-2">
                                    <i class="bi bi-pencil-square"></i>
                                </span>
                            </a>
                            <a href="{{ url_for('funcionario_delete', funcionario_id=dado.id) }}" class="btn-delete"
                                title="Deletar">
                                <span class="me-1 px-2">
                                    <i class="bi bi-trash"></i>
                                </span>
                            </a>
                        </td>
                        <td>{{ dado.id }}</td>
                        <td>{{ dado.nome }}</td>
                        <td>{{ dado.cpf }}</td>
                        <td>{{ dado.cargo }}</td>
                        <td>{{ dado.data_admissao }}</td>
                    </tr>
                    {% endfor %}
                    {% else %}
                    <tr>
                        <td colspan="5">Nenhum registro encontrado</td>
                        {% endif %}
                </tbody>
            </table>
        </div>
    </div>
</div>

{% include 'admin/modals/delete.html' %}
{% endblock %}
<script>
document.querySelectorAll('.btn-delete').forEach(function(btn) {
    btn.addEventListener('click', function(e) {
        e.preventDefault();
        fetch(btn.getAttribute('href'), { method: 'DELETE' })
            .then(() => location.reload())
            .catch(err => alert('Erro ao deletar!'));
    });
});
</script>